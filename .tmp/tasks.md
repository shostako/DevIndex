# DevIndex - 実装タスクリスト

**作成日**: 2025-11-24
**バージョン**: 2.0
**ベース**: `.tmp/requirements.md`, `.tmp/design.md`

---

## タスク分解の原則

1. **1タスク = 1-3時間**: 長すぎるタスクは分割
2. **依存関係の明示**: 順序を明確に
3. **成果物の定義**: 何ができたら完了か
4. **テスタブル**: 動作確認可能な単位

---

## Phase 0: プロジェクト基盤（Week 1: Day 1-2）

### T0.1: プロジェクト初期化
- **優先度**: 必須
- **所要時間**: 1時間
- **依存**: なし
- **内容**:
  - Next.js 14プロジェクト作成（App Router）
  - TypeScript strict mode設定
  - ESLint + Prettier設定
  - Tailwind CSS設定
- **成果物**:
  - `package.json`
  - `tsconfig.json`
  - `tailwind.config.js`
  - `.eslintrc.js`
- **確認方法**: `npm run dev`で起動確認

### T0.2: 依存パッケージインストール
- **優先度**: 必須
- **所要時間**: 30分
- **依存**: T0.1
- **内容**:
  - Dexie.js（IndexedDB）
  - Zustand（状態管理）
  - Fuse.js（検索）
  - Prism.js（シンタックスハイライト）
  - DOMPurify（サニタイゼーション）
  - next-pwa（PWA）
- **成果物**: `package.json`更新
- **確認方法**: `npm install`が成功

### T0.3: ディレクトリ構造作成
- **優先度**: 必須
- **所要時間**: 30分
- **依存**: T0.1
- **内容**:
  - `src/app/`（Next.js App Router）
  - `src/components/`（UIコンポーネント）
  - `src/lib/`（ビジネスロジック）
  - `src/types/`（型定義）
  - `src/hooks/`（カスタムフック）
  - `public/`（静的ファイル）
  - `docs/`（設計資料）
- **成果物**: ディレクトリ構造
- **確認方法**: `tree src/`で確認

### T0.4: 型定義作成
- **優先度**: 必須
- **所要時間**: 1時間
- **依存**: T0.3
- **内容**:
  - `types/term.ts`（Term型）
  - `types/progress.ts`（UserProgress型）
  - `types/quiz.ts`（Quiz関連型）
- **成果物**: TypeScript型定義ファイル
- **確認方法**: `npm run type-check`が成功

### T0.5: IndexedDBセットアップ（Dexie.js）
- **優先度**: 必須
- **所要時間**: 2時間
- **依存**: T0.2, T0.4
- **内容**:
  - `lib/db.ts`作成（Dexie定義）
  - `terms`, `user_progress`, `quiz_sessions`テーブル定義
  - インデックス設定
- **成果物**: `lib/db.ts`
- **確認方法**: ブラウザでIndexedDB作成を確認

### T0.6: 初期データ生成スクリプト
- **優先度**: 必須
- **所要時間**: 2時間
- **依存**: T0.4
- **内容**:
  - `scripts/generate-terms.ts`作成
  - 初期用語データ（20語）をJSON生成
  - カテゴリー定義
- **成果物**: `public/terms.json`
- **確認方法**: JSONが正しく生成される

### T0.7: データベース初期化処理
- **優先度**: 必須
- **所要時間**: 1.5時間
- **依存**: T0.5, T0.6
- **内容**:
  - `lib/db-init.ts`作成
  - `terms.json`読み込み
  - IndexedDBへ一括投入
  - 初回ロード処理
- **成果物**: `lib/db-init.ts`
- **確認方法**: ブラウザでIndexedDBにデータが入る

---

## Phase 1: 辞書機能（Week 1: Day 3-7）

### T1.1: レイアウトコンポーネント作成
- **優先度**: 必須
- **所要時間**: 2時間
- **依存**: T0.3
- **内容**:
  - `app/layout.tsx`（ルートレイアウト）
  - `components/layout/Header.tsx`
  - `components/layout/Sidebar.tsx`
  - `components/layout/ProgressBar.tsx`
- **成果物**: レイアウトコンポーネント
- **確認方法**: ヘッダー・サイドバーが表示される

### T1.2: Zustand Store作成（Terms）
- **優先度**: 必須
- **所要時間**: 2時間
- **依存**: T0.2, T0.5
- **内容**:
  - `lib/store.ts`作成
  - `useTermStore`（用語管理）
  - `useProgressStore`（進捗管理）
  - `useUIStore`（UI状態管理）
- **成果物**: `lib/store.ts`
- **確認方法**: Zustand DevToolsで確認

### T1.3: 検索エンジン実装
- **優先度**: 必須
- **所要時間**: 2.5時間
- **依存**: T0.2, T0.5
- **内容**:
  - `lib/search.ts`作成
  - Fuse.js初期化
  - あいまい検索実装
  - ハイライト機能
- **成果物**: `lib/search.ts`
- **確認方法**: 検索が50ms以内で動作

### T1.4: 検索バーコンポーネント
- **優先度**: 必須
- **所要時間**: 2時間
- **依存**: T1.2, T1.3
- **内容**:
  - `components/dictionary/SearchBar.tsx`
  - リアルタイム検索（Debounce 100ms）
  - キーボードショートカット（Ctrl+K）
- **成果物**: SearchBarコンポーネント
- **確認方法**: 検索が動作する

### T1.5: カテゴリーフィルタコンポーネント
- **優先度**: 必須
- **所要時間**: 1.5時間
- **依存**: T1.2
- **内容**:
  - `components/dictionary/CategoryFilter.tsx`
  - カテゴリー一覧表示
  - 選択・解除機能
- **成果物**: CategoryFilterコンポーネント
- **確認方法**: カテゴリーでフィルタできる

### T1.6: 用語カードコンポーネント
- **優先度**: 必須
- **所要時間**: 2.5時間
- **依存**: T0.4, T1.2
- **内容**:
  - `components/dictionary/TermCard.tsx`
  - カード型レイアウト
  - 習得レベルの色分け
  - 正答率表示
- **成果物**: TermCardコンポーネント
- **確認方法**: 用語がカード表示される

### T1.7: 用語一覧コンポーネント
- **優先度**: 必須
- **所要時間**: 2時間
- **依存**: T1.6
- **内容**:
  - `components/dictionary/TermList.tsx`
  - グリッドレイアウト（3カラム）
  - レスポンシブ対応
- **成果物**: TermListコンポーネント
- **確認方法**: 用語が一覧表示される

### T1.8: 用語詳細モーダル
- **優先度**: 必須
- **所要時間**: 3時間
- **依存**: T1.6
- **内容**:
  - `components/dictionary/TermDetail.tsx`
  - モーダルUI
  - マークダウンレンダリング（DOMPurify）
  - シンタックスハイライト（Prism.js）
  - Escで閉じる
- **成果物**: TermDetailモーダル
- **確認方法**: クリックで詳細が表示される

### T1.9: 辞書ページ統合
- **優先度**: 必須
- **所要時間**: 2時間
- **依存**: T1.1〜T1.8
- **内容**:
  - `app/page.tsx`作成
  - 全コンポーネントの統合
  - 初回データロード処理
- **成果物**: 動作する辞書ページ
- **確認方法**: 検索・フィルタ・詳細表示が動作

### T1.10: PWA設定
- **優先度**: 高
- **所要時間**: 1.5時間
- **依存**: T0.2
- **内容**:
  - `next.config.js`にnext-pwa設定
  - `public/manifest.json`作成
  - アイコン作成（192px, 512px）
  - Service Worker登録
- **成果物**: PWA設定
- **確認方法**: オフラインで動作、インストール可能

---

## Phase 2: クイズ機能（Week 2-3）

### T2.1: クイズ生成ロジック
- **優先度**: 高
- **所要時間**: 2.5時間
- **依存**: T0.5
- **内容**:
  - `lib/quiz.ts`作成
  - ランダム出題
  - カテゴリー指定出題
  - 弱点補強（正答率低い順）
- **成果物**: `lib/quiz.ts`
- **確認方法**: 条件に応じた問題が生成される

### T2.2: クイズ設定画面
- **優先度**: 高
- **所要時間**: 2時間
- **依存**: T2.1
- **内容**:
  - `components/quiz/QuizSetup.tsx`
  - 出題範囲選択UI
  - 難易度選択
  - タイマー設定
- **成果物**: QuizSetupコンポーネント
- **確認方法**: 設定画面が動作する

### T2.3: クイズカードコンポーネント
- **優先度**: 高
- **所要時間**: 3時間
- **依存**: T2.1
- **内容**:
  - `components/quiz/QuizCard.tsx`
  - カード型UI（表・裏）
  - フリップアニメーション
  - 記憶度評価（0-5）
- **成果物**: QuizCardコンポーネント
- **確認方法**: カードがめくれる、評価できる

### T2.4: クイズ実行ページ
- **優先度**: 高
- **所要時間**: 2.5時間
- **依存**: T2.2, T2.3
- **内容**:
  - `app/quiz/[sessionId]/page.tsx`
  - 問題出題フロー
  - 進捗表示（3/10問）
  - キーボード操作（スペース、1-5キー）
- **成果物**: クイズ実行ページ
- **確認方法**: クイズが最後まで動作する

### T2.5: クイズ結果画面
- **優先度**: 高
- **所要時間**: 2時間
- **依存**: T2.4
- **内容**:
  - `components/quiz/QuizResult.tsx`
  - スコア表示
  - 所要時間
  - 苦手用語リスト
  - 「復習に追加」ボタン
- **成果物**: QuizResultコンポーネント
- **確認方法**: 結果が正しく表示される

### T2.6: 進捗データ更新処理
- **優先度**: 高
- **所要時間**: 2時間
- **依存**: T2.4, T1.2
- **内容**:
  - クイズ結果をIndexedDBに保存
  - `user_progress`の正答率更新
  - `quiz_sessions`に履歴保存
- **成果物**: 進捗更新処理
- **確認方法**: IndexedDBが更新される

---

## Phase 3: SRS機能（Week 4-5）

### T3.1: SRSアルゴリズム実装
- **優先度**: 高
- **所要時間**: 3時間
- **依存**: T0.5
- **内容**:
  - `lib/srs.ts`作成
  - SM-2アルゴリズム実装
  - `calculateNextReview()`
  - `getTodayReviews()`
- **成果物**: `lib/srs.ts`
- **確認方法**: ユニットテストが通る

### T3.2: 復習カレンダーコンポーネント
- **優先度**: 中
- **所要時間**: 2.5時間
- **依存**: T3.1
- **内容**:
  - `components/srs/ReviewCalendar.tsx`
  - 今後7日間の復習予定を表示
  - 期限切れを赤表示
- **成果物**: ReviewCalendarコンポーネント
- **確認方法**: 復習予定が可視化される

### T3.3: 統計ダッシュボード
- **優先度**: 中
- **所要時間**: 3時間
- **依存**: T1.2, T3.1
- **内容**:
  - `app/srs/page.tsx`
  - 習得率（円グラフ）
  - 連続学習日数
  - カテゴリー別理解度（棒グラフ）
  - 苦手用語TOP 10
- **成果物**: SRSダッシュボード
- **確認方法**: 統計が正しく表示される

### T3.4: 復習実行ページ
- **優先度**: 高
- **所要時間**: 2時間
- **依存**: T2.3, T3.1
- **内容**:
  - `app/srs/review/page.tsx`
  - クイズモードと同じUI
  - 評価に応じてSRSパラメータ更新
- **成果物**: 復習実行ページ
- **確認方法**: 復習が動作する

### T3.5: 習得レベル管理
- **優先度**: 中
- **所要時間**: 1.5時間
- **依存**: T3.1, T1.2
- **内容**:
  - 評価に応じて`mastery_level`を更新
  - 用語カードの色分けに反映
- **成果物**: 習得レベル管理機能
- **確認方法**: レベルが正しく更新される

---

## Phase 4: 仕上げ（Week 5）

### T4.1: レスポンシブデザイン調整
- **優先度**: 高
- **所要時間**: 2時間
- **依存**: T1.1〜T3.5
- **内容**:
  - デスクトップ（3カラム）
  - タブレット（2カラム）
  - スマホ（1カラム）
- **成果物**: 全画面のレスポンシブ対応
- **確認方法**: 各デバイスで動作確認

### T4.2: キーボードショートカット実装
- **優先度**: 中
- **所要時間**: 1.5時間
- **依存**: T1.4, T1.8, T2.4
- **内容**:
  - `/` or `Ctrl+K`: 検索フォーカス
  - `Esc`: モーダルを閉じる
  - `↑/↓`: カード選択
  - `Enter`: 詳細表示
  - スペース: カードめくり
  - `1-5`: 評価
- **成果物**: キーボード操作
- **確認方法**: キーボードで全操作が可能

### T4.3: エラーハンドリング
- **優先度**: 高
- **所要時間**: 2時間
- **依存**: T0.5, T1.9
- **内容**:
  - IndexedDB初期化失敗時の処理
  - データ読み込みエラーのUI表示
  - リトライ機能
- **成果物**: エラーハンドリング
- **確認方法**: エラー時も適切に動作

### T4.4: パフォーマンス最適化
- **優先度**: 中
- **所要時間**: 2.5時間
- **依存**: T1.9, T2.4, T3.4
- **内容**:
  - React.memoで重いコンポーネントを最適化
  - useMemo / useCallback活用
  - Virtual Scrolling（用語数が多い場合）
  - Lighthouse計測
- **成果物**: パフォーマンス改善
- **確認方法**: Lighthouse Score 90+

### T4.5: ユニットテスト作成
- **優先度**: 中
- **所要時間**: 3時間
- **依存**: T1.3, T2.1, T3.1
- **内容**:
  - `lib/search.test.ts`
  - `lib/quiz.test.ts`
  - `lib/srs.test.ts`
  - カバレッジ70%以上
- **成果物**: ユニットテスト
- **確認方法**: `npm run test`が通る

### T4.6: CLAUDE.md作成
- **優先度**: 高
- **所要時間**: 1時間
- **依存**: なし
- **内容**:
  - DevIndex専用開発ルール
  - コマンド一覧
  - アーキテクチャ概要
  - 開発ワークフロー
- **成果物**: `CLAUDE.md`
- **確認方法**: 文書の完成

### T4.7: README.md更新
- **優先度**: 高
- **所要時間**: 1時間
- **依存**: なし
- **内容**:
  - プロジェクト概要
  - セットアップ手順
  - 開発コマンド
  - アーキテクチャ図
- **成果物**: `README.md`
- **確認方法**: 文書の完成

### T4.8: デプロイ設定
- **優先度**: 高
- **所要時間**: 1.5時間
- **依存**: T1.10
- **内容**:
  - Vercel設定（`vercel.json`）
  - 環境変数設定
  - CI/CD設定（GitHub Actions）
- **成果物**: デプロイ設定
- **確認方法**: Vercelにデプロイ成功

---

## タスク優先順位マトリクス

### 最優先（Phase 1完成に必須）
- T0.1〜T0.7（プロジェクト基盤）
- T1.1〜T1.9（辞書機能）
- T1.10（PWA設定）

### 高優先（Phase 2/3のコア機能）
- T2.1〜T2.6（クイズ機能）
- T3.1, T3.4（SRS基本機能）
- T4.1, T4.3（レスポンシブ・エラーハンドリング）

### 中優先（UX向上・統計機能）
- T3.2, T3.3, T3.5（SRS拡張機能）
- T4.2, T4.4, T4.5（キーボード・最適化・テスト）

### 低優先（ドキュメント）
- T4.6, T4.7（ドキュメント整備）

---

## 進捗管理

### TodoWrite連携
各Phaseの開始時に、主要タスクをTodoWriteに登録:
```
- [ ] Phase 0: プロジェクト基盤（T0.1〜T0.7）
- [ ] Phase 1: 辞書機能（T1.1〜T1.10）
- [ ] Phase 2: クイズ機能（T2.1〜T2.6）
- [ ] Phase 3: SRS機能（T3.1〜T3.5）
- [ ] Phase 4: 仕上げ（T4.1〜T4.8）
```

### マイルストーン
- **Week 1 End**: Phase 1完成（辞書機能が動作）
- **Week 3 End**: Phase 2完成（クイズが動作）
- **Week 5 End**: Phase 3完成（SRS機能完成）

---

**次のステップ**: Phase 0（プロジェクト基盤）の実装開始
